#ifndef STRACE_H
#define STRACE_H

////////////////////////////////////////////////////////////////////////////////
/// INCLUDES
////////////////////////////////////////////////////////////////////////////////

#include <stdio.h>
#include <stdlib.h>
#include <unistd.h>
#include <stdbool.h>

#include <errno.h>
#include <elf.h>
#include <sys/types.h>
#include <sys/stat.h>
#include <fcntl.h>

////////////////////////////////////////////////////////////////////////////////
/// DEFINES
////////////////////////////////////////////////////////////////////////////////

#define ELF_MAGIC_HASH 1179403647
#define ELF_MAGIC_SIZE 4
#define ELF_CLASS_SIZE 1

////////////////////////////////////////////////////////////////////////////////
/// ENUMS
////////////////////////////////////////////////////////////////////////////////

enum e_context
{
	ACCESS,
	OPEN,
	READ,
	ELF,
	CLASS,
};

////////////////////////////////////////////////////////////////////////////////
/// STRUCTURES
////////////////////////////////////////////////////////////////////////////////

struct s_binary
{
	const char *file;
	void (*handler)(void);
};

////////////////////////////////////////////////////////////////////////////////
/// DECLARATIONS
////////////////////////////////////////////////////////////////////////////////

void strace(const char *file);

struct s_binary get_binary(const char *file);

void error(const enum e_context context);

#endif
