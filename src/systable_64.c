#include <strace.h>
#include <asm/unistd_64.h>

////////////////////////////////////////////////////////////////////////////////
/// PUBLIC FUNCTION
////////////////////////////////////////////////////////////////////////////////

static const struct s_systable systable[] =
{
	{SYS_read, "read", 3},
	{SYS_write, "write", 3},
	{SYS_open, "open", 3},
	{SYS_close, "close", 1},
	{SYS_stat, "stat", 2},
	{SYS_fstat, "fstat", 2},
	{SYS_lstat, "lstat", 2},
	{SYS_poll, "poll", 3},
	{SYS_lseek, "lseek", 3},
	{SYS_mmap, "mmap", 6},
	{SYS_mprotect, "mprotect", 3},
	{SYS_munmap, "munmap", 2},
	{SYS_brk, "brk", 1},
	{SYS_rt_sigaction, "rt_sigaction", 4},
	{SYS_rt_sigprocmask, "rt_sigprocmask", 4},
	{SYS_rt_sigreturn, "rt_sigreturn", 1},
	{SYS_ioctl, "ioctl", 3},
	{SYS_pread64, "pread64", 4},
	{SYS_pwrite64, "pwrite64", 4},
	{SYS_readv, "readv", 3},
	{SYS_writev, "writev", 3},
	{SYS_access, "access", 2},
	{SYS_pipe, "pipe", 1},
	{SYS_select, "select", 5},
	{SYS_sched_yield, "sched_yield", 0},
	{SYS_mremap, "mremap", 5},
	{SYS_msync, "msync", 3},
	{SYS_mincore, "mincore", 3},
	{SYS_madvise, "madvise", 3},
	{SYS_shmget, "shmget", 3},
	{SYS_shmat, "shmat", 3},
	{SYS_shmctl, "shmctl", 3},
	{SYS_dup, "dup", 1},
	{SYS_dup2, "dup2", 2},
	{SYS_pause, "pause", 0},
	{SYS_nanosleep, "nanosleep", 2},
	{SYS_getitimer, "getitimer", 2},
	{SYS_alarm, "alarm", 1},
	{SYS_setitimer, "setitimer", 3},
	{SYS_getpid, "getpid", 0},
	{SYS_sendfile, "sendfile", 4},
	{SYS_socket, "socket", 3},
	{SYS_connect, "connect", 3},
	{SYS_accept, "accept", 3},
	{SYS_sendto, "sendto", 6},
	{SYS_recvfrom, "recvfrom", 6},
	{SYS_sendmsg, "sendmsg", 3},
	{SYS_recvmsg, "recvmsg", 3},
	{SYS_shutdown, "shutdown", 2},
	{SYS_bind, "bind", 3},
	{SYS_listen, "listen", 2},
	{SYS_getsockname, "getsockname", 3},
	{SYS_getpeername, "getpeername", 3},
	{SYS_socketpair, "socketpair", 4},
	{SYS_setsockopt, "setsockopt", 5},
	{SYS_getsockopt, "getsockopt", 5},
	{SYS_clone, "clone", 4},
	{SYS_fork, "fork", 0},
	{SYS_vfork, "vfork", 0},
	{SYS_execve, "execve", 3},
	{SYS_exit, "exit", 1},
	{SYS_wait4, "wait4", 4},
	{SYS_kill, "kill", 2},
	{SYS_semget, "semget", 3},
	{SYS_semop, "semop", 3},
	{SYS_semctl, "semctl", 4},
	{SYS_shmdt, "shmdt", 1},
	{SYS_msgget, "msgget", 2},
	{SYS_msgsnd, "msgsnd", 4},
	{SYS_msgrcv, "msgrcv", 5},
	{SYS_msgctl, "msgctl", 3},
	{SYS_fcntl, "fcntl", 3},
	{SYS_flock, "flock", 2},
	{SYS_fsync, "fsync", 1},
	{SYS_fdatasync, "fdatasync", 1},
	{SYS_truncate, "truncate", 2},
	{SYS_ftruncate, "ftruncate", 2},
	{SYS_getdents, "getdents", 3},
	{SYS_getcwd, "getcwd", 2},
	{SYS_chdir, "chdir", 1},
	{SYS_fchdir, "fchdir", 1},
	{SYS_rename, "rename", 2},
	{SYS_mkdir, "mkdir", 2},
	{SYS_rmdir, "rmdir", 1},
	{SYS_creat, "creat", 2},
	{SYS_link, "link", 2},
	{SYS_unlink, "unlink", 1},
	{SYS_symlink, "symlink", 2},
	{SYS_readlink, "readlink", 3},
	{SYS_chmod, "chmod", 2},
	{SYS_fchmod, "fchmod", 2},
	{SYS_chown, "chown", 3},
	{SYS_fchown, "fchown", 3},
	{SYS_lchown, "lchown", 3},
	{SYS_umask, "umask", 1},
	{SYS_gettimeofday, "gettimeofday", 2},
	{SYS_getrlimit, "getrlimit", 1},
	{SYS_getrusage, "getrusage", 2},
	{SYS_sysinfo, "sysinfo", 1},
	{SYS_times, "times", 1},
	{SYS_ptrace, "ptrace", 4},
	{SYS_getuid, "getuid", 0},
	{SYS_syslog, "syslog", 3},
	{SYS_getgid, "getgid", 0},
	{SYS_setuid, "setuid", 1},
	{SYS_setgid, "setgid", 1},
	{SYS_geteuid, "geteuid", 0},
	{SYS_getegid, "getegid", 0},
	{SYS_setpgid, "setpgid", 2},
	{SYS_getppid, "getppid", 0},
	{SYS_getpgrp, "getpgrp", 0},
	{SYS_setsid, "setsid", 0},
	{SYS_setreuid, "setreuid", 2},
	{SYS_setregid, "setregid", 2},
	{SYS_getgroups, "getgroups", 2},
	{SYS_setgroups, "setgroups", 2},
	{SYS_setresuid, "setresuid", 3},
	{SYS_getresuid, "getresuid", 3},
	{SYS_setresgid, "setresgid", 3},
	{SYS_getresgid, "getresgid", 3},
	{SYS_getpgid, "getpgid", 1},
	{SYS_setfsuid, "setfsuid", 1},
	{SYS_setfsgid, "setfsgid", 1},
	{SYS_getsid, "getsid", 1},
	{SYS_capget, "capget", 2},
	{SYS_capset, "capset", 2},
	{SYS_rt_sigpending, "rt_sigpending", 2},
	{SYS_rt_sigtimedwait, "rt_sigtimedwait", 4},
	{SYS_rt_sigqueueinfo, "rt_sigqueueinfo", 3},
	{SYS_rt_sigsuspend, "rt_sigsuspend", 2},
	{SYS_sigaltstack, "sigaltstack", 2},
	{SYS_utime, "utime", 2},
	{SYS_mknod, "mknod", 3},
	{SYS_uselib, "uselib", 1},
	{SYS_personality, "personality", 1},
	{SYS_ustat, "ustat", 2},
	{SYS_statfs, "statfs", 2},
	{SYS_fstatfs, "fstatfs", 2},
	{SYS_sysfs, "sysfs", 3},
	{SYS_getpriority, "getpriority", 2},
	{SYS_setpriority, "setpriority", 3},
	{SYS_sched_setparam, "sched_setparam", 2},
	{SYS_sched_getparam, "sched_getparam", 2},
	{SYS_sched_setscheduler, "sched_setscheduler", 3},
	{SYS_sched_getscheduler, "sched_getscheduler", 1},
	{SYS_sched_get_priority_max, "sched_get_priority_max", 1},
	{SYS_sched_get_priority_min, "sched_get_priority_min", 1},
	{SYS_sched_rr_get_interval, "sched_rr_get_interval", 2},
	{SYS_mlock, "mlock", 2},
	{SYS_munlock, "munlock", 2},
	{SYS_mlockall, "mlockall", 1},
	{SYS_munlockall, "munlockall", 0},
	{SYS_vhangup, "vhangup", 0},
	{SYS_modify_ldt, "modify_ldt", 3},
	{SYS_pivot_root, "pivot_root", 2},
	{SYS__sysctl, "sysctl", 1},
	{SYS_prctl, "prctl", 4},
	{SYS_arch_prctl, "arch_prctl", 2},
	{SYS_adjtimex, "adjtimex", 1},
	{SYS_setrlimit, "setrlimit", 2},
	{SYS_chroot, "chroot", 1},
	{SYS_sync, "sync", 0},
	{SYS_acct, "acct", 1},
	{SYS_settimeofday, "settimeofday", 2},
	{SYS_mount, "mount", 5},
	{SYS_umount2, "umount2", 2},
	{SYS_swapon, "swapon", 2},
	{SYS_swapoff, "swapoff", 1},
	{SYS_reboot, "reboot", 4},
	{SYS_sethostname, "sethostname", 2},
	{SYS_setdomainname, "setdomainname", 2},
	{SYS_iopl, "iopl", 2},
	{SYS_ioperm, "ioperm", 3},
	{SYS_create_module, "create_module", 0},
	{SYS_init_module, "init_module", 3},
	{SYS_delete_module, "delete_module", 2},
	{SYS_get_kernel_syms, "get_kernel_syms", 0},
	{SYS_query_module, "query_module", 0},
	{SYS_quotactl, "quotactl", 4},
	{SYS_nfsservctl, "nfsservctl", 0},
	{SYS_getpmsg, "getpmsg", 0},
	{SYS_putpmsg, "putpmsg", 0},
	{SYS_afs_syscall, "afs_syscall", 0},
	{SYS_tuxcall, "tuxcall", 0},
	{SYS_security, "security", 0},
	{SYS_gettid, "gettid", 0},
	{SYS_readahead, "readahead", 3},
	{SYS_setxattr, "setxattr", 5},
	{SYS_lsetxattr, "lsetxattr", 5},
	{SYS_fsetxattr, "fsetxattr", 5},
	{SYS_getxattr, "getxattr", 4},
	{SYS_lgetxattr, "lgetxattr", 4},
	{SYS_fgetxattr, "fgetxattr", 4},
	{SYS_listxattr, "listxattr", 3},
	{SYS_llistxattr, "llistxattr", 3},
	{SYS_flistxattr, "flistxattr", 3},
	{SYS_removexattr, "removexattr", 2},
	{SYS_lremovexattr, "lremovexattr", 2},
	{SYS_fremovexattr, "fremovexattr", 2},
	{SYS_tkill, "tkill", 2},
	{SYS_time, "time", 1},
	{SYS_futex, "futex", 6},
	{SYS_sched_setaffinity, "sched_setaffinity", 3},
	{SYS_sched_getaffinity, "sched_getaffinity", 3},
	{SYS_set_thread_area, "set_thread_area", 1},
	{SYS_io_setup, "io_setup", 2},
	{SYS_io_destroy, "io_destroy", 1},
	{SYS_io_getevents, "io_getevents", 4},
	{SYS_io_submit, "io_submit", 3},
	{SYS_io_cancel, "io_cancel", 3},
	{SYS_get_thread_area, "get_thread_area", 1},
	{SYS_lookup_dcookie, "lookup_dcookie", 3},
	{SYS_epoll_create, "epoll_create", 1},
	{SYS_epoll_ctl_old, "epoll_ctl_old", 0},
	{SYS_epoll_wait_old, "epoll_wait_old", 0},
	{SYS_remap_file_pages, "remap_file_pages", 5},
	{SYS_getdents64, "getdents64", 3},
	{SYS_set_tid_address, "set_tid_address", 1},
	{SYS_restart_syscall, "restart_syscall", 0},
	{SYS_semtimedop, "semtimedop", 4},
	{SYS_fadvise64, "fadvise64", 4},
	{SYS_timer_create, "timer_create", 3},
	{SYS_timer_settime, "timer_settime", 4},
	{SYS_timer_gettime, "timer_gettime", 2},
	{SYS_timer_getoverrun, "timer_getoverrun", 1},
	{SYS_timer_delete, "timer_delete", 1},
	{SYS_clock_settime, "clock_settime", 2},
	{SYS_clock_gettime, "clock_gettime", 2},
	{SYS_clock_getres, "clock_getres", 2},
	{SYS_clock_nanosleep, "clock_nanosleep", 4},
	{SYS_exit_group, "exit_group", 1},
	{SYS_epoll_wait, "epoll_wait", 4},
	{SYS_epoll_ctl, "epoll_ctl", 4},
	{SYS_tgkill, "tgkill", 3},
	{SYS_utimes, "utimes", 2},
	{SYS_vserver, "vserver", 0},
	{SYS_mbind, "mbind", 6},
	{SYS_set_mempolicy, "set_mempolicy", 3},
	{SYS_get_mempolicy, "get_mempolicy", 5},
	{SYS_mq_open, "mq_open", 4},
	{SYS_mq_unlink, "mq_unlink", 1},
	{SYS_mq_timedsend, "mq_timedsend", 5},
	{SYS_mq_timedreceive, "mq_timedreceive", 5},
	{SYS_mq_notify, "mq_notify", 2},
	{SYS_mq_getsetattr, "mq_getsetattr", 2},
	{SYS_kexec_load, "kexec_load", 4},
	{SYS_waitid, "waitid", 5},
	{SYS_add_key, "add_key", 4},
	{SYS_request_key, "request_key", 4},
	{SYS_keyctl, "keyctl", 5},
	{SYS_ioprio_set, "ioprio_set", 3},
	{SYS_ioprio_get, "ioprio_get", 2},
	{SYS_inotify_init, "inotify_init", 0},
	{SYS_inotify_add_watch, "inotify_add_watch", 3},
	{SYS_inotify_rm_watch, "inotify_rm_watch", 2},
	{SYS_migrate_pages, "migrate_pages", 4},
	{SYS_openat, "openat", 3},
	{SYS_mkdirat, "mkdirat", 3},
	{SYS_mknodat, "mknodat", 4},
	{SYS_fchownat, "fchownat", 5},
	{SYS_futimesat, "futimesat", 3},
	{SYS_newfstatat, "newfstatat", 4},
	{SYS_unlinkat, "unlinkat", 3},
	{SYS_renameat, "renameat", 4},
	{SYS_linkat, "linkat", 5},
	{SYS_symlinkat, "symlinkat", 3},
	{SYS_readlinkat, "readlinkat", 4},
	{SYS_fchmodat, "fchmodat", 3},
	{SYS_faccessat, "faccessat", 3},
	{SYS_pselect6, "pselect6", 6},
	{SYS_ppoll, "ppoll", 5},
	{SYS_unshare, "unshare", 1},
	{SYS_set_robust_list, "set_robust_list", 2},
	{SYS_get_robust_list, "get_robust_list", 3},
	{SYS_splice, "splice", 6},
	{SYS_tee, "tee", 4},
	{SYS_sync_file_range, "sync_file_range", 4},
	{SYS_vmsplice, "vmsplice", 4},
	{SYS_move_pages, "move_pages", 6},
	{SYS_utimensat, "utimensat", 4},
	{SYS_epoll_pwait, "epoll_pwait", 6},
	{SYS_signalfd, "signalfd", 3},
	{SYS_timerfd_create, "timerfd_create", 2},
	{SYS_eventfd, "eventfd", 1},
	{SYS_fallocate, "fallocate", 4},
	{SYS_timerfd_settime, "timerfd_settime", 4},
	{SYS_timerfd_gettime, "timerfd_gettime", 2},
	{SYS_accept4, "accept4", 4},
	{SYS_signalfd4, "signalfd4", 4},
	{SYS_eventfd2, "eventfd2", 2},
	{SYS_epoll_create1, "epoll_create1", 1},
	{SYS_dup3, "dup3", 3},
	{SYS_pipe2, "pipe2", 2},
	{SYS_inotify_init1, "inotify_init1", 1},
	{SYS_preadv, "preadv", 5},
	{SYS_pwritev, "pwritev", 5},
	{SYS_rt_tgsigqueueinfo, "rt_tgsigqueueinfo", 4},
	{SYS_perf_event_open, "perf_event_open", 5},
	{SYS_recvmmsg, "recvmmsg", 5},
	{SYS_fanotify_init, "fanotify_init", 2},
	{SYS_fanotify_mark, "fanotify_mark", 5},
	{SYS_prlimit64, "prlimit64", 4},
	{SYS_name_to_handle_at, "name_to_handle_at", 5},
	{SYS_open_by_handle_at, "open_by_handle_at", 5},
	{SYS_clock_adjtime, "clock_adjtime", 2},
	{SYS_syncfs, "syncfs", 1},
	{SYS_sendmmsg, "sendmmsg", 4},
	{SYS_setns, "setns", 2},
	{SYS_getcpu, "getcpu", 3},
	{SYS_process_vm_readv, "process_vm_readv", 6},
	{SYS_process_vm_writev, "process_vm_writev", 6},
	{SYS_kcmp, "kcmp", 5},
	{SYS_finit_module, "finit_module", 3},
	{SYS_sched_setattr, "sched_setattr", 3},
	{SYS_sched_getattr, "sched_getattr", 4},
	{SYS_renameat2, "renameat2", 5},
	{SYS_seccomp, "seccomp", 3},
	{SYS_getrandom, "getrandom", 3},
	{SYS_memfd_create, "memfd_create", 2},
	{SYS_kexec_file_load, "kexec_file_load", 5},
	{SYS_bpf, "bpf", 3},
	{SYS_execveat, "execveat", 5},
	{SYS_userfaultfd, "userfaultfd", 1},
	{SYS_membarrier, "membarrier", 2},
	{SYS_mlock2, "mlock2", 3},
	{SYS_copy_file_range, "copy_file_range", 6},
	{SYS_preadv2, "preadv2", 6},
	{SYS_pwritev2, "pwritev2", 6},
};

const char *get_syscall_64(const int id)
{
	const size_t size = sizeof(systable) / sizeof(*systable);

	for (register size_t index = 0; index < size; index += 1)
	{
		if (id == systable[index].id)
			return systable[index].name;
	}

	return "unknown syscall";
}

int get_nparameters_64(const int id)
{
	const size_t size = sizeof(systable) / sizeof(*systable);

	for (register size_t index = 0; index < size; index += 1)
	{
		if (id == systable[index].id)
			return systable[index].nparameters;
	}

	return -1;
}
